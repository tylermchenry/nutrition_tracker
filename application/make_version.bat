@echo off

rem Windows batch files are truly awful. :(

echo /* This file is automatically generated and any changes will be destroyed */ > version.cpp

set version=
for /f "delims=" %%i in (VERSION) do if not defined version set version=%%i 
echo const char* NUTRITIONTRACKER_VERSION="%VERSION%"; >> version.cpp

set revision=
for /f "delims=" %%i in ('"C:\Program Files\Git\bin\git.exe" rev-parse HEAD') do if not defined revision set revision=%%i 
echo const char* NUTRITIONTRACKER_GIT_COMMIT="%REVISION%"; >> version.cpp

set builddate=
for /f "delims=" %%i in ('date /T') do if not defined builddate set builddate=%%i 
set buildtime=
for /f "delims=" %%i in ('time /T') do if not defined buildtime set buildtime=%%i 
echo const char* NUTRITIONTRACKER_BUILD_TIMESTAMP="%BUILDDATE%%BUILDTIME%"; >> version.cpp